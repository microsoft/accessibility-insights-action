export default Statistics;
export type StatisticsOptions = {
    logIntervalSecs?: number;
    logMessage?: string;
};
/**
 * Format of the persisted stats
 */
export type StatisticPersistedState = {
    requestRetryHistogram: number[];
    statsId: number;
    requestAvgFailedDurationMillis: number;
    requestAvgFinishedDurationMillis: number;
    requestsFinishedPerMinute: number;
    requestsFailedPerMinute: number;
    requestTotalDurationMillis: number;
    requestsTotal: number;
    crawlerRuntimeMillis: number;
    crawlerLastStartTimestamp: number;
    statsPersistedAt: string;
};
/**
 * Contains the statistics state
 */
export type StatisticState = {
    requestsFinished: number;
    requestsFailed: number;
    requestsRetries: number;
    requestsFailedPerMinute: number;
    requestsFinishedPerMinute: number;
    requestMinDurationMillis: number;
    requestMaxDurationMillis: number;
    requestTotalFailedDurationMillis: number;
    requestTotalFinishedDurationMillis: number;
    crawlerStartedAt: string | Date | null;
    crawlerFinishedAt: string | Date | null;
    crawlerRuntimeMillis: number;
    statsPersistedAt: string | Date | null;
};
/**
 * The statistics class provides an interface to collecting and logging run
 * statistics for requests.
 *
 * All statistic information is saved on key value store
 * under the key SDK_CRAWLER_STATISTICS_*, persists between
 * migrations and abort/resurrect
 *
 * @property {StatisticState} state
 *   Current statistic state used for doing calculations on {@link Statistics#calculate} calls
 * @property {number} id
 *   Statistic instance id
 * @property {number[]} requestRetryHistogram
 *   Contains the current retries histogram.
 *   Index 0 means 0 retries, index 2, 2 retries,
 *   and so on
 */
declare class Statistics {
    /**
     * @param {StatisticsOptions} options
     * @hideconstructor
     */
    constructor(options?: StatisticsOptions);
    log: defaultLog.Log;
    logIntervalMillis: number;
    logMessage: string;
    keyValueStore: import("../key_value_store").KeyValueStore | null;
    id: number;
    persistStateKey: string;
    listener: () => Promise<void>;
    requestRetryHistogram: any[];
    /**
     * @private
     * @type {Map<string | number, Job>}
     */
    private requestsInProgress;
    /**
     * Set the current statistic instance to pristine values
     */
    reset(): void;
    state: {
        requestsFinished: number;
        requestsFailed: number;
        requestsRetries: number;
        requestsFailedPerMinute: number;
        requestsFinishedPerMinute: number;
        requestMinDurationMillis: number;
        requestMaxDurationMillis: number;
        requestTotalFailedDurationMillis: number;
        requestTotalFinishedDurationMillis: number;
        crawlerStartedAt: null;
        crawlerFinishedAt: null;
        statsPersistedAt: null;
        crawlerRuntimeMillis: number;
    } | undefined;
    instanceStart: number | undefined;
    /**
     * Starts a job
     *
     * @param {number|string} id
     * @ignore
     */
    startJob(id: string | number): void;
    /**
     * Mark job as finished and sets the state
     *
     * @param {number|string} id
     * @ignore
     */
    finishJob(id: string | number): void;
    /**
     * Mark job as failed and sets the state
     *
     * @param {number|string} id
     * @ignore
     */
    failJob(id: string | number): void;
    /**
     * Calculate the current statistics
     */
    calculate(): {
        requestAvgFailedDurationMillis: number;
        requestAvgFinishedDurationMillis: number;
        requestsFinishedPerMinute: number;
        requestsFailedPerMinute: number;
        requestTotalDurationMillis: any;
        requestsTotal: any;
        crawlerRuntimeMillis: number;
    };
    /**
     * Initializes the key value store for persisting the statistics,
     * displaying the current state in predefined intervals
     */
    startCapturing(): Promise<void>;
    logInterval: NodeJS.Timeout | null | undefined;
    /**
     * Stops logging and remove event listeners, then persist
     */
    stopCapturing(): Promise<void>;
    /**
     * @private
     * @param {Job} job
     */
    private _saveRetryCountForJob;
    /**
     * Persist internal state to the key value store
     */
    persistState(): Promise<void>;
    /**
     * Loads the current statistic from the key value store if any
     * @private
     */
    private _maybeLoadStatistics;
    /**
     * @private
     */
    private _teardown;
    /**
     * Make this class serializable when called with `JSON.stringify(statsInstance)` directly
     * or through `keyValueStore.setValue('KEY', statsInstance)`
     *
     * @returns {StatisticPersistedState | StatisticState}
     */
    toJSON(): StatisticPersistedState | StatisticState;
}
declare namespace Statistics {
    export const id: number;
}
import defaultLog from "../utils_log";
