<!--
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the MIT License.
-->

<!--
DO NOT EDIT THIS FILE DIRECTLY

If you would like to change an input, edit packages/ado-extension/task.json
If you would like to change the layout of this file, edit packages/ado-extension/scripts/documentation.js

To rebuild this file, run "yarn docs" or "yarn precheckin"
-->

# Accessibility Insights for Azure DevOps inputs

## Required inputs

-   `url` (string) **Required**. The URL to scan and crawl for accessibility issues.

or

-   `staticSiteDir` (string) **Required**. The directory containing built HTML files that the extension will serve, scan, and crawl for accessibility issues.

## Optional inputs

-   `staticSiteUrlRelativePath` (string). Default: `/`. If using `staticSiteDir`, you can set the base URL when the site lives at a subpath of the domain, such as `/blog`. If unspecified, the site will be scanned at the root.

-   `staticSitePort` (int). If using `staticSiteDir`, you can set the local website TCP port for the extension to use when serving the static site. If unspecified, a port will be set automatically. If the pipeline serves additional processes, set the port to avoid conflicts. If using `baselineFile`, set the port to make sure future scans will match the baseline file.

-   `authType` (Choose one: `AAD` - Azure Active Directory). For sites with authenticated pages, use with `serviceAccountName` and `serviceAccountPassword` to specify the authentication type. Learn [how to set up authentication](https://aka.ms/AI-action-auth).

-   `serviceAccountName` (string). For sites with authenticated pages, set the email address for the non-people service account. Use the Key Vault task to securely set the email address. Learn [how to set up authentication with Key Vault](https://aka.ms/AI-action-auth).

-   `serviceAccountPassword` (string). For sites with authenticated pages, set the password for the non-people service account. Use the Key Vault task to securely set the password. Learn [how to set up authentication with Key Vault](https://aka.ms/AI-action-auth).

-   `maxUrls` (int). Default: `100`. Maximum number of pages opened by crawler. The crawl will stop when this limit is reached.

-   `discoveryPatterns` (string). List of RegEx patterns to crawl in addition to the provided URL, separated by space.

-   `inputFile` (string). File path that contains list of URLs (each separated by a new line) to scan in addition to URLs discovered from crawling the provided URL.

-   `inputUrls` (string). List of URLs to crawl in addition to URLs discovered from crawling the provided URL, separated by space.

-   `scanTimeout` (int). Default: `90000`. The maximum timeout in milliseconds for the scan (excluding dependency setup).

-   `failOnAccessibilityError` (boolean). Default: `true`. Fail the task if there are accessibility issues. See [Intentional failures](#intentional-failures) for more information.

-   `baselineFile` (string). The old baseline file path, a new baseline will be generated with the same name. If unspecified, the baseline option will be disabled. See [Intentional failures](#intentional-failures) for more information.

-   `singleWorker` (boolean). Default: `true`. To get deterministic scanning results when this value is set to `false`, make sure the value for `maxUrls` is larger than the total number of URLs in the website being scanned.

-   `uploadOutputArtifact` (boolean). Default: `true`. Automatically upload the result as an artifact to the build. Set to `false` if you need to upload the artifact manually in a separate task or publish step.

-   `outputArtifactName` (string). Default: `accessibility-reports`. Name of the report artifact to be uploaded to the build. Ignored if `uploadOutputArtifact` is `false`.

-   `outputDir` (string). Directory to write the scan output to. Its contents will be uploaded as a pipeline artifact unless `uploadOutputArtifact` is set to `false`. If unspecified, output will be written to a generated temporary directory.

-   `snapshot` (boolean). Save snapshots of scanned pages as artifacts. These snapshots will show you exactly what the scanner sees when scanning the page. This requires `uploadOutputArtifact` to not be set to `false`.

-   `chromePath` (string). Path to Chrome executable. By default, the task downloads a version of Chrome that is tested to work with this task.

## Intentional failures

The ADO extension reports an intentional failure if _either_ of the following cases are true:

-   The `failOnAccessibilityError` option is `true` and any accessibility errors are found.
-   The `baselineFile` option is specified and any changes are detected between the currently reported set of errors and the set of errors previously captured in `baselineFile`.

Note that these two failure modes and their associated options operate _independently_ of each other. Where feasible, the `baselineFile` option is usually the more powerful option, as it can enable both the _get clean_ and _stay clean_ scenarios. The `failOnAccessibilityError` option can realistically enable only the _stay clean_ scenario.
