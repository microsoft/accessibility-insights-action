# Copyright (c) Microsoft Corporation. All rights reserved.
# Licensed under the MIT License.
name: 'Accessibility Insights Action'
description: 'Task to scan for accessibility issues'
inputs:
    output-dir:
        description: 'folder containing the generated report'
        default: '_accessibility-reports'
        required: true
    site-dir:
        description: 'folder containing site content'
        default: ${{ github.workspace }}
        required: true
    scan-url-relative-path:
        description: 'relative path from url domain. Eg: /index.html'
        required: true
        default: '/'
    chrome-path:
        description: 'path to chrome executable'
        required: false
    repo-token:
        description: 'github token'
        required: true
runs:
    using: 'composite'
    steps:
        - run: ls ${{ github.action_path }} #npm install
          shell: bash
        - run: |
            if [[ $ACT == true ]]; then
              apt-get update \
              && apt-get install -y curl gnupg \
              && curl https://dl-ssl.google.com/linux/linux_signing_key.pub | apt-key add - \
              && curl -LO https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb \
              && apt-get install -y ./google-chrome-stable_current_amd64.deb \
              && rm ./google-chrome-stable_current_amd64.deb
            fi
          shell: bash
        - run: node ./dist/index.js
          shell: bash